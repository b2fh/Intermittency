\section{Curvature Perturbations from Ballistic Dynamics During Preheating}
Let's now consider how the trajectory dynamics and development of caustics manifest in preheating, and eventually lead to the production of (non-Gaussian) curvature perturbations.
We focus on a specific model in this section, although from the discussion it should be evident that the generic features leading to the production of curvature perturbations will appear in a wide variety of models.
Ultimately, we want to compute the curvature perturbation $\zeta = \ln a|_{\rho}(\chi_i)$ subject to the constraint of some initial mean value
\begin{equation}
  \chi_i^{(H_e)} \equiv \langle \chi \rangle_{H_e^{-1}}
\end{equation}
where the spatial average is taken over a local Hubble volume on the end of inflation hypersurface.

In section~\ref{sec:} we presented calculations of $\langle \zeta | \chi_i \rangle_{H_e}$ for a specific preheating model using full three-dimensional lattice simulations.
We also presented some preliminary evidence that the detailed structure of the resultant curvature perturbations could be understood in terms of smoothed motions of bundles of decoupled ballistic trajectories evolving in the potential.
We will now expand on this observation and demonstrate that the production of curvature spikes from the preheating dynamics can be understood in terms of the formation of caustics in the dynamics of trajectories.

In the ballistic approximation, an $n$-field scalar field model interacting with gravity lives in a $2n+2$-dimensional phase space along with a single constraint $3H^2 = \rho$.
To illustrate the basic phenomena, we take our single-particle Lagrangian to be (up to a total derivative)
\begin{equation}
  L = \frac{a^2}{2}\dot{\phi}^2 + \frac{a^2}{2}\dot{\chi}^2 - a^4\frac{\lambda}{4}\left(\phi^4 + \frac{g^2}{\lambda}\phi^2\chi^2\right) - 3M_P^2\dot{a}^2 + 3M_P^2\partial_\tau(a\dot{a})
\end{equation}
For simplicity, we set $M_P=1$ in what follows.

It is convenient to choose $\varphi_1 = a\phi$ and $\varphi_2 = a\chi$ as canonical field variables, with corresponding canonical momenta $\Pi_1 = a\dot{\phi}$ and $\Pi_2=a\dot{\chi}$ where a dot represents a derivative with respect to conformal time $\tau$.
In terms of these variables, the Hamiltonian is
\begin{equation}
  \mathcal{H} = \frac{\Pi_1^2}{2} + \frac{\Pi_2^2}{2} + \left(\varphi_1\Pi_1 + \varphi_2\Pi_2\right)\frac{\Pi_a}{a} + \frac{\lambda}{4}\left(\varphi_1^4 + \frac{2g^2}{\lambda}\varphi_1^2\vartheta_2^2 \right) - \frac{\Pi_a^2}{12 M_P^2}
\end{equation}
with the constraint
\begin{equation}
  \mathcal{H} = 0
\end{equation}
These yield the following equations of motion
\begin{align}\label{eqn:eom_scale}
  \frac{\partial\varphi_i}{\partial\tau} &= \Pi_i + \frac{\Pi_a}{a}\varphi_i \\
  \frac{\partial\Pi_i}{\partial\tau}     &= -\frac{\dot{a}}{a}\Pi_i - \frac{\partial \tilde{V}}{\partial\varphi} \\
  \frac{\partial a}{\partial\tau}        &= -\frac{\Pi_a}{6M_P^2} \\
  \frac{\partial\Pi_a}{\partial\tau}     &= \frac{\Pi_a}{a^2}\sum_i\varphi_i\Pi_i
\end{align}
where $\tilde{V}(\vec{\varphi}) = a^{-4}V(\vec{\phi})$.
Alternatively, in unscaled field variables $\phi,\chi$ we have
\begin{equation}
  \mathcal{H} = \sum_i\frac{\pi_i^2}{2a^2} + a^4V(\vec{\phi}) - \frac{\Pi_a^2}{12M_P^2}
\end{equation}
and equations
\begin{align}\label{eqn:eom_noscale}
  \frac{\partial\phi_i}{\partial\tau} &= \frac{\pi_i^2}{a^2} \\
  \frac{\partial\pi_i}{\partial_\tau} &= -a^4 \partial_iV(\phi) \\
  \frac{\partial a}{\partial\tau}     &= -\frac{\Pi_a}{6M_P^2} \\
  \frac{\partial\Pi_a}{\partial\tau}  &= \sum_i\frac{\pi_i^2}{a^3} - a^3V \, .
\end{align}

To connect to our lattice simulations, we consider the evolution of a collection of decoupled ballistic trajectories.
These trajectories are centered on the mean values of the fundamental fields in the corresponding lattice simulations, and each one receives a weight corresponding to the probability that the particular value would be realised amongst the subhorizon fluctuations.
The mean value is drawn from the distribution of superhorizon values $\chi_i$, and each ballistic trajectory is then meant to simulate the evolution of the fields on subhorizon scales.
Therefore, we can completely specify the relevant initial data .
For Gaussian subhorizon fluctuations relevant to the case of cosmological preheating, the subhorizon joint PDF can be obtained by the covariance matrix.
To emulate the lattice simulations, we then compute equivalent lattice averages of functions of the basic field variables by evaluating the expectation value over the initial field bundle.

This approach should be valid in cases where the most unstable field mode is initially the zero-mode.
Although this is not completely generic, we will argue below that this occurs wide range of shapes near the local minima of the scalar field potential.
The computational gain from such an approach is tremendous.

In order to emulate our lattice simulations, we will consider two hierarchies of smoothings.
In the first, we allow the mean field $\chi_i$ to vary at the start of the simulation.  At a fixed conformal time $\tau$ later we then extract whichever observable quantities we want by {\bf convolving with a Gaussian kernel on the initial trajectories in the cloud}.
\begin{equation}
  \langle\mathcal{O}|\chi_i,\sigma\rangle(\tau) = H_I^{-1}\int d^3x 
\end{equation}
These smoothed quantities then approximate the results that would be obtained from running a lattice simulation.
We are most interested in $\zeta(\chi_i)$, so we now evaluate these smoothed trajectory bundles at a fixed value of the smoothed density $\rho$.



    {\bf More generally, we should take an initial Gaussian cloud in all of the field phase space directions and follow this.  We don't need to follow $a^2H$ since that is constrained (and we just solve the constraint initially), and we could just take $\ln a$ as a time variable since it is monotonic, so we can safely set $a=1$ through a reparameterisation of time along the trajectory.  Alternatively, in the simulations $a$ is initially the same at each grid site.}

{\bf Emphasize the tremendous computational gain from this approach}

We solve the equations of motion~\eqref{eqn:eom_noscale} using a tenth order accurate Gauss-Legendre integrator~\cite{Butcher,Braden}.
This integration scheme is symplectic, preserving quadratic invariants of the action as well as the canonical symplectic 2-form for the Hamiltonian system.
As will be seen, this dynamical system exhibits chaotic behaviour for a range of coupling parameter $2g^2/\lambda$.
Therefore, the preservation of the phase-space structure by our integration scheme is of prime importance when attempting to compute averaged quantities over a cloud of initial trajectories,
since the chaotic motion would quickly destroy preservation of probabilities for an inferior integration scheme.
Due to the extreme accuracy of our integrator, we are able to preserve the Hamiltonian constraint $\mathcal{H}=0$ to machine precision along each individual ballistic trajectory.
{\bf Figure?  Can explicitly see the bit-flipping and corresponding random walk over time if I plot this.  Probably a good idea to also halve the time-step and compare trajectories.}

%In this sense, it is more natural to consider the equations for the longitudinal and transverse parts of the field {\bf Work out this and do the calculation}.
%An approximate, but less technically involved approach, is to instead consider the radial and angular parts of the field defined through
%\begin{align}
%  \phi &= \sigma\cos\theta \\
%  \chi &= \sigma\sin\theta
%\end{align}

\begin{figure}
  \caption{Caustic plot in $\Pi_a = a^2H$.  On the left show the ballistic trajectory one (with appropriate smoothings), on the right show the full lattice simulation one.}
\end{figure}
{\bf Explain the structure in this caustic plot.  The periodicity is easy to understand.  Obtaining the basic structural block requires numerics.  We should also be able to get the scaling of the peaks widths, etc through some reasonably simple argument.  The existence of two distinct peaks occurs because there are 2 arms? (could easily check with another model with 3 arms say).  Substructure comes from usual period doubling and extreme coiling of the string as time evolves.}

We now present the evolution for a single period of the caustic structure in the initial values of $\ln\chi_i$.
For our example, this period is controlled by the Floquet exponent $\mu T_\phi$ for linear perturbations in $\chi$ around a trajectory with $\chi=0$.
As is well known, this problem can be reduced to the solution of the Lame equation~\cite{KofmanGreene} up to small corrections associated with the evolution of the scale factor $a$.
From the ballistic viewpoint, this stage is more naturally viewed as a rotation of trajectory's oscillation ``plane'' {\bf line?} in both the $(\phi,\chi)$ and $(\dot{\phi},\dot{\chi})$ planes.

\begin{figure}
  \caption{Length of the phase string as a function of time.  Here we have defined our metric on phase space as $ds^2 = d\varphi_1^2+d\varphi_2^2 + \Pi_1^2 + \Pi_2^2$.  In addition to the full length of the string, we also show }
\end{figure}

\begin{figure}
  \caption{Response of the phase space variables to small initial perturbations in the modulating field value $\delta\chi$.}
\end{figure}

\begin{figure}
  \includegraphics[width=0.49\linewidth]{{{phase-string-3d_t600}}}
  \includegraphics[width=0.49\linewidth]{{{phase-string-3d_t625}}}
  \caption{Three-Dimensional Projection of the initial phase string into the $(a\phi,a\chi,a\dot{\phi})$ cube.  The full phase string is shown in black.  The projections onto three remaining two-dimensional planes are shown in blue.  Also included for reference are isocontours on constant potential energy, energy in $\phi$ (with $\chi=0$) and ..., along with the isocontour corresponding to the initial value of the energy.  Since the momenta associated with the scale factor $a$ is conserved in time average, these initial isocontours can be viewed as roughly showing the projection of the constraint surface $\mathcal{H}=0$ into the appropriate planes.  From left to right we show the distribution at $\tau = $,$\tau = $, and $\tau = $.}
\end{figure}

\begin{figure}
  \caption{Entropy of projected PDF as a function of time?}
\end{figure}

\begin{figure}
  \caption{Distribution of $\ln a$ for a Gaussian bundle of trajectories centered around a spike (\emph{left}) and without a spike (\emph{right}).}
\end{figure}

{\bf To Do:  Fix the initial Hubble to be the same at the start of each inidividual trajectory?  Might remove one of the ugly splitting issues.}
