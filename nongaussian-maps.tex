\section{CMB Maps from Generalised Local NonGaussianity}
\begin{itemize}
\item Description of the form of nonGaussianity produced by these models.
\item Description of how to do marginalisation from coarse-grained distribution (ie. smoothed over a Hubble at the end of inflation) to pixels in CMB of LSS
\item T and E maps from generalised local nonGaussianity
\end{itemize}

For an observer,  the primordial comoving curvature fluctuations  $\zeta$ can be expanded with spherical harmonics
\begin{equation}
  \zeta(r, \mathbf{n}) = \sum_{lm} Y_{lm}(\mathbf{n})\zeta_{lm}(r),
\end{equation}
where $r$ is the distance from the observer and $\mathbf{n} = (\theta, \phi)$ the line of sight direction. For linear projection, the projected temperature harmonic coefficient $a_{lm}^T$ is a superposition of $\zeta_{lm}(r)$ with appropriate weights $F_l^T(r)$. In this subsection we derive $F_l^T(r)$ and describe the numeric techniques to compute it.

 For a comoving wave number $\mathbf{k}$, the Fourier mode $\zeta_{\mathbf{k}}$ can be written as
\begin{equation}
  \zeta_{\mathbf{k}} = 4\pi \int_0^\infty r^2dr\sum_{lm}\zeta_{lm}(r) (-i)^l j_l(kr) Y_{lm}(\hat{\mathbf{k}})\, , \label{eq:zetakint}
\end{equation}
where we have used the identity
\begin{equation}
  e^{i\mathbf{k}\cdot\mathbf{n}r} = 4\pi \sum_{lm}i^l j_l(kr) Y^*_{lm}(\hat{\mathbf{k}}) Y_{lm}(\mathbf{n}) \, , \label{eq:eikx_expand}
\end{equation}
and orthogonality of $Y_{lm}$ functions.


The temperature field can be integrated along the line of sight
\begin{equation}
T({\mathbf{n}}) = \int S_T(\mathbf{k}, \chi) e^{i \mathbf{k}\cdot\mathbf{n} \chi}\zeta_{\mathbf{k}}\frac{d^3k}{(2\pi)^3}, \label{eq:Tint1}
\end{equation}
where $S(\mathbf{k}, \chi)$ is the source function that can be computed using a Boltzmann code.

Plugging \eqref{eq:zetakint} and \eqref{eq:eikx_expand} into \eqref{eq:Tint1}, we obtain the desired expression
\begin{equation}
a_{lm}^T = \int_0^\infty r^2dr \zeta_{lm}(r) F^T_l(r), \label{eq:Tint2}
\end{equation}
where
\begin{equation}
F^T_l(r) = \frac{2}{\pi} \int k^2dk j_l(kr) \int d\chi S_T(k, \chi) j_l(k\chi) \, . \label{eq:FTint}
\end{equation}

Although it seems to be profitable to convert the 3D integral \eqref{eq:Tint2} to 2D by first integrating over $\chi$ in \eqref{eq:FTint}, practically it is not the case. Because the source $S(k, \chi)$ is relatively smooth, it acts as a low-pass filter on the product of bessel functions $j_l(kr)j_l(k\chi)$. The numerical accuracy can be greately enhanced by doing a WKB expansion of $j_l(kr)j_l(k\chi)$ and keeping only the low frequency part of it. The high frequency part of $j_l(kr)j_l(k\chi)$ only adds noises which average to zero. In other words, $k$ direction is the proper direction to analyse the convergence of the integral. We can analytically remove the large but periodic oscillatory noises in $k$ direction to achieve a much faster convergence.


